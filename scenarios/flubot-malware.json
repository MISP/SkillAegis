{
    "exercise": {
        "description": "MISP Encoding Exercise : Flubot Malware",
        "expanded": "MISP Encoding Exercise : Flubot Malware",
        "meta": {
            "author": "MISP Project",
            "level": "beginner",
            "priority": 5
        },
        "name": "MISP Encoding Exercise : Flubot Malware",
        "namespace": "data-model",
        "tags": [
            "exercise:software-scope=\"misp\"",
            "state:production"
        ],
        "total_duration": "7200",
        "uuid": "a7cb0e57-83f4-4c10-9f5f-6c54877b685e",
        "version": "20240702"
    },
    "inject_flow": [
        {
            "inject_uuid": "104377cb-cb45-4f6e-affb-2bc1350a4212",
            "description": "phishing-sms",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "5a449087-ff74-4dea-9d97-d09dd2abe0b8",
            "description": "phone-number",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "1729e6f9-b899-47b4-b3e8-c3e02f2a2ff8",
            "description": "phishing-url&IP",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "a4ba921e-744f-4f58-9958-a7d59ff5ff62",
            "description": "apk",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "9dc28a53-9011-4cb0-b9df-bff3fe095de1",
            "description": "CVE",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "f995b04d-4648-41b6-893b-19eeebd365ef",
            "description": "c2",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "2d9a7cf7-25d2-4224-9f61-6aba91adfa78",
            "description": "yara",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "05b3e7aa-b761-4f65-92e9-eed84e48a6a4",
            "description": "Contextualization",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        },
        {
            "inject_uuid": "49df070b-f6fc-47c3-bf43-92454f1582d5",
            "description": "Published",
            "requirements": {},
            "sequence": {
                "completion_trigger": [
                    "time_expiration",
                    "completion"
                ],
                "followed_by": [],
                "trigger": []
            },
            "timing": {
                "triggered_at": null,
                "periodic_run_every": null
            }
        }
    ],
    "inject_payloads": [],
    "injects": [
        {
            "name": "Phishing SMS",
            "action": "phishing-sms",
            "target_tool": "MISP",
            "uuid": "104377cb-cb45-4f6e-affb-2bc1350a4212",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            ".Event.Object[] | select((.name == \"short-message-service\")).Attribute[] | select((.type == \"text\")).value": {
                                "extract_type": "all",
                                "comparison": "contains-regex",
                                "values": [
                                    "Missed Call: You have a missed call\\..*"
                                ]
                            }
                        }
                    ],
                    "result": "SMS added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "Phone Number",
            "action": "phone-number",
            "target_tool": "MISP",
            "uuid": "5a449087-ff74-4dea-9d97-d09dd2abe0b8",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            "[.Event.Object[].Attribute[], .Event.Attribute[]] | .[] | select((.type == \"phone-number\")).value": {
                                "extract_type": "all",
                                "comparison": "contains-regex",
                                "values": [
                                    "\\+?352131575"
                                ]
                            }
                        }
                    ],
                    "result": "Phone Number added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "Download URL & IP",
            "action": "url",
            "target_tool": "MISP",
            "uuid": "1729e6f9-b899-47b4-b3e8-c3e02f2a2ff8",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            ".Event.Object[].Attribute[] | select((.type == \"url\")).value": {
                                "extract_type": "all",
                                "comparison": "equals",
                                "values": [
                                    "https://evilprovider.com/r.php?e1525c0f"
                                ]
                            }
                        },
                        {
                            ".Event.Object[].Attribute[] | select(.object_relation == \"query_string\").value": {
                                "extract_type": "all",
                                "comparison": "equals",
                                "values": [
                                    ".?e1525c0f"
                                ]
                            }
                        }
                    ],
                    "result": "Download URL added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "Malicious APK",
            "action": "apk",
            "target_tool": "MISP",
            "uuid": "a4ba921e-744f-4f58-9958-a7d59ff5ff62",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            ".Event.Object[].Attribute[] | select((.type == \"sha1\")).value": {
                                "extract_type": "all",
                                "comparison": "equals",
                                "values": [
                                    "4714aaa5195da29c6e74aeee9e9f19678af5c15b"
                                ]
                            }
                        }
                    ],
                    "result": "APK added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "CVE",
            "action": "cve",
            "target_tool": "MISP",
            "uuid": "9dc28a53-9011-4cb0-b9df-bff3fe095de1",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            "[.Event.Object[].Attribute[], .Event.Attribute[]] | .[] | select((.type == \"vulnerability\")).value": {
                                "extract_type": "all",
                                "comparison": "equals",
                                "values": [
                                    "CVE-2022-27835"
                                ]
                            }
                        }
                    ],
                    "result": "CVE added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "C2 Server",
            "action": "c2",
            "target_tool": "MISP",
            "uuid": "f995b04d-4648-41b6-893b-19eeebd365ef",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            ".Event.Object[] | select((.name == \"url\")).Attribute[] | select((.type == \"url\")).value": {
                                "extract_type": "all",
                                "comparison": "equals",
                                "values": [
                                    "https://another.evil.provider.com:42666/c.php?e1525c0f"
                                ]
                            }
                        },
                        {
                            ".Event.Object[] | select((.name == \"url\")).Attribute[] | select((.type == \"domain\") or (.type == \"hostname\")).value": {
                                "extract_type": "all",
                                "comparison": "equals",
                                "values": [
                                    "another.evil.provider.com"
                                ]
                            }
                        },
                        {
                            ".Event.Object[] | select((.name == \"url\")).Attribute[] | select((.object_relation == \"ip\")).value": {
                                "extract_type": "all",
                                "comparison": "equals",
                                "values": [
                                    "226.140.183.77"
                                ]
                            }
                        }
                    ],
                    "result": "C2 added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "Yara Rule",
            "action": "yara",
            "target_tool": "MISP",
            "uuid": "2d9a7cf7-25d2-4224-9f61-6aba91adfa78",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            "[.Event.Object[].Attribute[], .Event.Attribute[]] | .[] | select((.type == \"yara\")).value": {
                                "extract_type": "all",
                                "comparison": "contains-regex",
                                "values": [
                                    "rule android_flubot \\{.*"
                                ]
                            }
                        }
                    ],
                    "result": "Yara rule added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "Contextualization",
            "action": "context",
            "target_tool": "MISP",
            "uuid": "05b3e7aa-b761-4f65-92e9-eed84e48a6a4",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            ".Event.Tag | select(length > 0) | .[].name": {
                                "extract_type": "all",
                                "comparison": "count",
                                "values": [
                                    ">=3"
                                ]
                            }
                        }
                    ],
                    "result": "Context added",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        },
        {
            "name": "Published",
            "action": "published",
            "target_tool": "MISP",
            "uuid": "49df070b-f6fc-47c3-bf43-92454f1582d5",
            "description": null,
            "inject_evaluation": [
                {
                    "parameters": [
                        {
                            ".Event.published": {
                                "comparison": "equals",
                                "values": [
                                    "1"
                                ]
                            }
                        }
                    ],
                    "result": "Event published",
                    "evaluation_strategy": "data_filtering",
                    "evaluation_context": {},
                    "score_range": [
                        0,
                        20
                    ]
                }
            ],
            "inject_evaluation_join_type": null
        }
    ]
}